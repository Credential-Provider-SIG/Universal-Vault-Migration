# Universal Vault Migration

A collaboration effort between multiple Credential Providers to ~kill the csv~ migrate securely between different ecosystems. Historically transfering secrets from one vendor to another would use clear-text data such as `csv` or `json` formated files. This would usually expose your secrets to disk in clear text as an intermediate step between the export and import steps. This file is not guaranteed to be deleted after the import, therefore bypassing the security of having these secrets encrypted in your new vault.

This protocol has two aims:
1. Define a Universal Vault Data Format (UVDF) that all providers understand.
2. Define an encryption scheme protecting the UVDF in transit between providers.

## Proposed Flow

When a user wants to transfer their data, they first initiate the import data flow on their new password manager application (the receiving app).

This application generates a pair of private/public keys using an Elliptic Curve X25519 and shares a JSON object called [OpenBox], which contains the generated public key.

After this, the user transfers the object to the application they want to export the data from (the sending app). They can use any transport handled by the applications.

The sending app decodes the JSON and extracts the public key, then generates its own Elliptic Curve X25519 key pair.

Once the new key pair is generated, the sending app generates a symmetric key by performing an Elliptic Curve Diffie-Hellman key agreement over X25519. This key is used to seal the userâ€™s data under the [Vault] JSON format.

The encrypted data is stored in a [SealedBox] JSON object. It contains the public key generated by the sending app, the salt used to generate the symmetric key, and an encrypted blob containing the encrypted data.

The user then transfers the generated [SealedBox] to the receiving app, which decodes the JSON, extracts the public key, and generates the symmetric key. It uses the symmetric key to decrypt the [Vault] blob.

[OpenBox]: ./Schema/OpenBox.schema.json
[SealedBox]: ./Schema/SealedBox.schema.json
[Vault]: ./Schema/Vault.schema.json